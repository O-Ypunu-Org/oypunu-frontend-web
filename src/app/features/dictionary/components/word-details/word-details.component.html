<div class="min-h-screen bg-gray-950" style="font-family: 'Inter', sans-serif;">

  <!-- ‚îÄ‚îÄ‚îÄ En-t√™te sticky ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="sticky top-0 z-10 bg-gray-950">
    <div class="w-full max-w-3xl mx-auto flex items-center justify-between px-4 sm:px-6 py-3">

      <!-- Retour -->
      <button type="button" routerLink="/dictionary" class="w-9 h-9 flex items-center justify-center rounded-full bg-gray-800
               hover:bg-gray-700 text-gray-300 hover:text-white transition-colors flex-shrink-0"
        title="Retour au dictionnaire">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"
          stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
        </svg>
      </button>

      <!-- Actions (droite) -->
      <div *ngIf="word" class="flex items-center gap-1">

        <!-- Modifier -->
        <button *ngIf="canEdit" type="button" (click)="onEditWord()" class="w-9 h-9 flex items-center justify-center rounded-full hover:bg-gray-800
                 text-primary-400 hover:text-primary-300 transition-colors" title="Modifier ce mot">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
          </svg>
        </button>

        <!-- Audio (premier fichier dispo) -->
        <button *ngIf="hasAudioFiles()" type="button" (click)="playAudio(getFirstAudioUrl() || '')" class="w-9 h-9 flex items-center justify-center rounded-full hover:bg-gray-800
                 text-primary-400 hover:text-primary-300 transition-colors" title="√âcouter la prononciation">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd"
              d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
              clip-rule="evenodd" />
          </svg>
        </button>

        <!-- Partager -->
        <button type="button" (click)="onShare()" class="w-9 h-9 flex items-center justify-center rounded-full hover:bg-gray-800
                 text-gray-400 hover:text-gray-300 transition-colors" title="Partager ce mot">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
          </svg>
        </button>

        <!-- Favori -->
        <button type="button" (click)="toggleFavorite()"
          class="w-9 h-9 flex items-center justify-center rounded-full hover:bg-gray-800 transition-colors"
          [class.text-purple-600]="word.isFavorite" [class.text-gray-400]="!word.isFavorite"
          [title]="word.isFavorite ? 'Retirer des favoris' : 'Ajouter aux favoris'">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5"
            [attr.fill]="word.isFavorite ? 'currentColor' : 'none'" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
          </svg>
        </button>

      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ Zone de contenu ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="w-full max-w-3xl mx-auto px-4 sm:px-6 py-4 sm:py-6 pb-24">

    <!-- Chargement -->
    <div *ngIf="isLoading" class="flex flex-col items-center justify-center py-20 gap-3">
      <div class="w-10 h-10 border-2 border-gray-700 border-t-purple-600 rounded-full animate-spin"></div>
      <p class="text-sm text-gray-400">Chargement‚Ä¶</p>
    </div>

    <!-- Erreur -->
    <div *ngIf="error && !isLoading" class="flex flex-col items-center justify-center py-20 gap-4 text-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-red-400" fill="none" viewBox="0 0 24 24"
        stroke="currentColor" stroke-width="1.5">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <p class="text-base text-red-400">{{ error }}</p>
      <a routerLink="/dictionary" class="text-sm text-purple-400 hover:text-purple-300 transition-colors">
        ‚Üê Retour √† la recherche
      </a>
    </div>

    <!-- ‚îÄ‚îÄ‚îÄ Contenu du mot ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <ng-container *ngIf="word && !isLoading">

      <!-- ‚îÄ‚îÄ‚îÄ Carte : mot principal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div class="bg-gray-900 rounded-xl border border-gray-800 p-5 mb-4">
        <h1 class="text-3xl sm:text-4xl font-bold text-white mb-3" style="letter-spacing: -0.25px;">{{ word.word | capitalize }}</h1>

        <!-- Langue + prononciation -->
        <div class="flex items-center flex-wrap gap-x-2 gap-y-1 mt-1">
          <span *ngIf="getLanguageDisplay()" class="text-sm text-gray-300 font-medium">
            {{ getLanguageDisplay() }}
          </span>
          <span *ngIf="getLanguageDisplay() && word.pronunciation" class="text-sm text-gray-500">‚Ä¢</span>
          <span *ngIf="word.pronunciation" class="text-sm text-gray-400">/{{ word.pronunciation }}/</span>
        </div>

        <!-- Cat√©gorie -->
        <div *ngIf="getCategory()" class="mt-2">
          <span class="text-xs px-2.5 py-1 bg-gray-800 border border-gray-700 text-gray-300 rounded-full">
            {{ getCategory() }}
          </span>
        </div>

        <!-- Statut (si pas approuv√©) -->
        <span *ngIf="word.status !== 'approved'" class="inline-block mt-3 text-xs px-2.5 py-1 rounded-full font-medium"
          [ngClass]="getStatusBadgeClass(word.status)">
          {{ getStatusText(word.status) }}
        </span>

        <!-- √âtymologie -->
        <div *ngIf="word.etymology" class="mt-4 pt-4 border-t border-gray-800">
          <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1.5">√âtymologie</p>
          <p class="text-gray-300 italic text-sm leading-relaxed">{{ word.etymology }}</p>
        </div>
      </div>

      <!-- ‚îÄ‚îÄ‚îÄ Carte : d√©finitions ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div *ngIf="word.meanings && word.meanings.length > 0"
        class="bg-gray-900 rounded-xl border border-gray-800 p-5 mb-4">
        <p class="text-sm font-semibold text-gray-300 uppercase tracking-wider mb-4">D√©finitions</p>

        <ng-container *ngFor="let meaning of word.meanings; let mi = index">
          <div [class.mt-6]="mi > 0" [class.pt-6]="mi > 0" [class.border-t]="mi > 0" [class.border-gray-800]="mi > 0">

            <!-- Badge partie du discours -->
            <span class="inline-block px-2.5 py-0.5 rounded-full mb-3 capitalize
                         text-xs font-medium bg-primary-500/15 text-primary-400">
              {{ getPartOfSpeechName(meaning.partOfSpeech) }}
            </span>

            <!-- D√©finitions -->
            <div *ngIf="meaning.definitions && meaning.definitions.length > 0" class="space-y-4">
              <div *ngFor="let def of meaning.definitions; let i = index" class="flex gap-3">
                <span class="text-primary-400 font-bold text-sm mt-0.5 flex-shrink-0 w-5 text-right">
                  {{ i + 1 }}.
                </span>
                <div class="flex-1 min-w-0">
                  <p class="text-white text-sm leading-relaxed">{{ def.definition }}</p>
                  <!-- Exemples inline -->
                  <div *ngIf="def.examples && def.examples.length > 0"
                    class="mt-2 space-y-1 pl-3 border-l-2 border-gray-700">
                    <p *ngFor="let ex of def.examples" class="text-gray-500 italic text-xs leading-relaxed">
                      ¬´ {{ ex }} ¬ª
                    </p>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </ng-container>
      </div>

      <!-- ‚îÄ‚îÄ‚îÄ Carte : synonymes ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div *ngIf="hasSynonyms()" class="bg-gray-900 rounded-xl border border-gray-800 p-5 mb-4">
        <p class="text-sm font-semibold text-gray-300 uppercase tracking-wider mb-4">Synonymes</p>
        <div class="flex flex-wrap gap-2">
          <ng-container *ngFor="let meaning of word.meanings">
            <button *ngFor="let synonym of meaning.synonyms" type="button" (click)="navigateToWord(synonym)" class="px-3 py-1.5 bg-primary-50/10 hover:bg-primary-50/20 border border-primary-200/30
                     rounded-full text-sm text-primary-400 hover:text-primary-300 transition-colors">
              {{ synonym }}
            </button>
          </ng-container>
        </div>
      </div>

      <!-- ‚îÄ‚îÄ‚îÄ Carte : antonymes ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div *ngIf="hasAntonyms()" class="bg-gray-900 rounded-xl border border-gray-800 p-5 mb-4">
        <p class="text-sm font-semibold text-gray-300 uppercase tracking-wider mb-4">Antonymes</p>
        <div class="flex flex-wrap gap-2">
          <ng-container *ngFor="let meaning of word.meanings">
            <button *ngFor="let antonym of meaning.antonyms" type="button" (click)="navigateToWord(antonym)" class="px-3 py-1.5 bg-primary-50/10 hover:bg-primary-50/20 border border-primary-200/30
                     rounded-full text-sm text-primary-400 hover:text-primary-300 transition-colors">
              {{ antonym }}
            </button>
          </ng-container>
        </div>
      </div>

      <!-- ‚îÄ‚îÄ‚îÄ Carte : traductions ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div class="bg-gray-900 rounded-xl border border-gray-800 p-5 mb-4">
        <p class="text-sm font-semibold text-gray-300 uppercase tracking-wider mb-4">üåê Traductions</p>
        <app-word-translations [word]="word"></app-word-translations>
      </div>

      <!-- ‚îÄ‚îÄ‚îÄ Carte : prononciations audio ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div *ngIf="hasAudioFiles()" class="bg-gray-900 rounded-xl border border-gray-800 p-5 mb-4">
        <p class="text-sm font-semibold text-gray-300 uppercase tracking-wider mb-4">Prononciations</p>
        <div class="space-y-2">
          <div *ngFor="let audioFile of getAudioAccents()"
            class="flex items-center justify-between bg-gray-800 rounded-lg px-4 py-3">
            <div class="flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-purple-400" fill="none" viewBox="0 0 24 24"
                stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M15.536 8.464a5 5 0 010 7.072M12 6v12M8.464 8.464a5 5 0 000 7.072" />
              </svg>
              <span class="text-sm text-gray-300">{{ audioFile.accent }}</span>
            </div>
            <button type="button" (click)="playAudio(audioFile.url)" class="flex items-center gap-1.5 px-3 py-1.5 bg-purple-600 hover:bg-purple-700
                     text-white text-xs font-medium rounded-lg transition-colors">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-3.5 h-3.5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                  clip-rule="evenodd" />
              </svg>
              √âcouter
            </button>
          </div>
        </div>
      </div>

      <!-- ‚îÄ‚îÄ‚îÄ Carte : informations ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
      <div class="bg-gray-900 rounded-xl border border-gray-800 p-5 mb-4">
        <p class="text-sm font-semibold text-gray-300 uppercase tracking-wider mb-4">Informations</p>
        <dl class="space-y-3">
          <div *ngIf="word.createdBy" class="flex items-center justify-between">
            <dt class="text-sm text-gray-400">Auteur</dt>
            <dd class="text-sm text-white font-medium">{{ getCreatedBy(word.createdBy) }}</dd>
          </div>
          <div *ngIf="word.createdAt" class="flex items-center justify-between">
            <dt class="text-sm text-gray-400">Ajout√© le</dt>
            <dd class="text-sm text-gray-200">{{ word.createdAt | date:'dd MMM yyyy' }}</dd>
          </div>
          <div *ngIf="word.updatedAt" class="flex items-center justify-between">
            <dt class="text-sm text-gray-400">Mis √† jour</dt>
            <dd class="text-sm text-gray-200">{{ word.updatedAt | date:'dd MMM yyyy' }}</dd>
          </div>
          <div class="flex items-center justify-between">
            <dt class="text-sm text-gray-400">Statut</dt>
            <dd>
              <span class="text-xs px-2.5 py-0.5 rounded-full font-medium" [ngClass]="getStatusBadgeClass(word.status)">
                {{ getStatusText(word.status) }}
              </span>
            </dd>
          </div>
        </dl>
      </div>

    </ng-container>
  </div>
</div>

<!-- Modal d'inscription pour les visiteurs qui ont atteint leurs limites -->
<app-signup-prompt-modal *ngIf="showSignupModal && !isAuthenticated && guestLimits" [isOpen]="showSignupModal"
  [wordsViewed]="guestLimits.wordsViewed" [maxWords]="guestLimits.maxWordsPerDay"
  [communitiesViewed]="guestLimits.communitiesViewed" [maxCommunities]="guestLimits.maxCommunitiesPerDay"
  (onClose)="closeSignupModal()" (onSignup)="goToSignup()" (onLogin)="goToLogin()">
</app-signup-prompt-modal>